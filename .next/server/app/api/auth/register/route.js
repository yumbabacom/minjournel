(()=>{var e={};e.id=612,e.ids=[612],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2518:e=>{"use strict";e.exports=require("mongodb")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3834:(e,r,t)=>{"use strict";let s;t.d(r,{$V:()=>d,Ay:()=>p});var o=t(6037),a=t.n(o),n=t(2518);let i=process.env.MONGODB_URI||"mongodb+srv://tmuneebanjum:A5Y1enJBJcDVwPrt@jorn.nx9fd28.mongodb.net/smartsave",u="trading-journal";if(!i)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let l=global.mongoose;async function c(){if(l.conn)return l.conn;l.promise||(l.promise=a().connect(i,{bufferCommands:!1}).then(e=>e));try{l.conn=await l.promise}catch(e){throw l.promise=null,e}return l.conn}async function d(){try{let e=await s;console.log("Connected to MongoDB successfully, using database:",u);let r=e.db(u);return{client:e,db:r}}catch(e){throw console.error("Failed to connect to database:",e),e}}l||(l=global.mongoose={conn:null,promise:null}),s=new n.MongoClient(i).connect();let p=c},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:e=>{"use strict";e.exports=require("crypto")},6037:e=>{"use strict";e.exports=require("mongoose")},6487:()=>{},6944:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>w,routeModule:()=>d,serverHooks:()=>h,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{POST:()=>c});var o=t(6559),a=t(8088),n=t(7719),i=t(2190),u=t(3834),l=t(7652);async function c(e){try{let{fullName:r,email:t,password:s,confirmPassword:o}=await e.json();if(!r||!t||!s||!o)return i.NextResponse.json({error:"Please fill in all fields"},{status:400});if(s!==o)return i.NextResponse.json({error:"Passwords do not match"},{status:400});if(s.length<6)return i.NextResponse.json({error:"Password must be at least 6 characters long"},{status:400});if(await (0,u.Ay)(),await l.A.findOne({email:t.toLowerCase()}))return i.NextResponse.json({error:"User with this email already exists"},{status:400});let a=new l.A({fullName:r,email:t.toLowerCase(),password:s});return await a.save(),i.NextResponse.json({message:"User registered successfully",user:a.toPublicJSON()},{status:201})}catch(e){if(console.error("Registration error:",e),"ValidationError"===e.name){let r=Object.values(e.errors).map(e=>e.message);return i.NextResponse.json({error:r[0]},{status:400})}if(11e3===e.code)return i.NextResponse.json({error:"User with this email already exists"},{status:400});return i.NextResponse.json({error:"Internal server error"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/home/runner/work/minjournel/minjournel/app/api/auth/register/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:m,serverHooks:h}=d;function w(){return(0,n.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:m})}},7652:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(6037),o=t.n(s),a=t(5663);let n=new(o()).Schema({fullName:{type:String,required:[!0,"Please provide a full name"],maxlength:[60,"Name cannot be more than 60 characters"]},email:{type:String,required:[!0,"Please provide an email"],unique:!0,lowercase:!0,match:[/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,"Please provide a valid email"]},password:{type:String,required:[!0,"Please provide a password"],minlength:[6,"Password must be at least 6 characters"],select:!1},createdAt:{type:Date,default:Date.now},lastLogin:{type:Date},isActive:{type:Boolean,default:!0}});n.pre("save",async function(e){if(!this.isModified("password"))return e();try{let r=await a.Ay.hash(this.password,12);this.password=r,e()}catch(r){e(r)}}),n.methods.comparePassword=async function(e){return await a.Ay.compare(e,this.password)},n.methods.toPublicJSON=function(){let e=this.toObject();return delete e.password,e};let i=o().models.User||o().model("User",n)},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[447,580,663],()=>t(6944));module.exports=s})();